name: Monitor de Chamados

on:
  schedule:
    # A cada 5 minutos das 18h Ã s 23h UTC (15h-20h BrasÃ­lia)
    - cron: "*/5 18-23 * * *"
    # A cada 5 minutos da 00h Ã s 02h UTC (21h-23h BrasÃ­lia)
    - cron: "*/5 0-2 * * *"
  workflow_dispatch: # permite rodar manualmente

jobs:
  monitor:
    runs-on: ubuntu-latest

    steps:
      - name: ðŸ“¥ Clonar repositÃ³rio
        uses: actions/checkout@v3

      - name: ðŸ“¦ Configurar Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 18

      - name: ðŸ“‚ Instalar dependÃªncias
        run: npm install

      - name: ðŸš€ Rodar monitor
        run: node monitor/principal.js
        env:
          SITE_USER: ${{ secrets.SITE_USER }}
          SITE_PASS: ${{ secrets.SITE_PASS }}
          SITE_DOMINIO: ${{ secrets.SITE_DOMINIO }}
          TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
