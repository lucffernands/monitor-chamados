name: Monitor de Chamados

concurrency:
  group: monitor-de-chamados
  cancel-in-progress: false  # Se true, cancela execuÃ§Ãµes antigas quando uma nova Ã© disparada

on:
  # Temporariamente desativado para testes
  # schedule:
  #   - cron: "*/5 18-23 * * *"
  #   - cron: "*/5 0-2 * * *"
  workflow_dispatch: # permite rodar manualmente

jobs:
  monitor:
    runs-on: ubuntu-latest

    steps:
      - name: ðŸ“¥ Clonar repositÃ³rio
        uses: actions/checkout@v3

      - name: ðŸ“¦ Configurar Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 18

      - name: ðŸ“‚ Instalar dependÃªncias
        run: npm install

      - name: ðŸš€ Rodar monitor
        run: node monitor/principal.js
        env:
          MS_USER: ${{ secrets.MS_USER }}
          MS_PASS: ${{ secrets.MS_PASS }}
          TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
